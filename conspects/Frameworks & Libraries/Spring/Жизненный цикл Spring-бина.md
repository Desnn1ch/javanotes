
Бин в Spring — это объект, который управляется IoC-контейнером (ApplicationContext). Жизненный цикл описывает, какие шаги проходит объект от создания до уничтожения.

---

## 1. Создание экземпляра

Spring создаёт объект класса бина. Это происходит через вызов конструктора (или фабричного метода, если бин определён как `@Bean`). На этом этапе объект существует, но зависимости ещё не внедрены.

---

## 2. Внедрение зависимостей (Dependency Injection)

Spring внедряет в бин все необходимые зависимости, объявленные через:

- конструктор (`@Autowired` в конструкторе),
- поля (`@Autowired`, `@Value`),
- сеттеры.

К этому моменту бин получает все необходимые коллаборации.

---

## 3. Callback-интерфейсы Aware

Если бин реализует специальные интерфейсы, Spring вызовет методы этих интерфейсов, чтобы передать в бин информацию о контейнере:

- `BeanNameAware` — передаёт имя бина в контейнере.
- `BeanFactoryAware` — передаёт ссылку на `BeanFactory`.
- `ApplicationContextAware` — передаёт `ApplicationContext`.
- Существуют и другие `Aware`-интерфейсы (например, `EnvironmentAware`, `ResourceLoaderAware`).

Это позволяет бину получить доступ к инфраструктуре Spring.

---

## 4. BeanPostProcessor (этап до инициализации)

Контейнер запускает все зарегистрированные `BeanPostProcessor`.  
Метод `postProcessBeforeInitialization` вызывается до этапа инициализации.  
Именно здесь может произойти оборачивание бина в прокси (например, для AOP, транзакций или асинхронного выполнения).

---

## 5. Инициализация бина

На этом этапе контейнер выполняет код, связанный с инициализацией. Возможны несколько механизмов:

- Метод, помеченный `@PostConstruct`.
- Реализация интерфейса `InitializingBean` → вызов `afterPropertiesSet()`.
- Явно указанный `initMethod` в конфигурации `@Bean(initMethod = "init")`.

Порядок такой:

1. `@PostConstruct`
2. `afterPropertiesSet()`
3. `initMethod`

Таким образом, бин получает возможность выполнить кастомную инициализацию сразу после того, как все зависимости внедрены.

---

## 6. BeanPostProcessor (этап после инициализации)

После выполнения инициализационных методов Spring снова проходит по `BeanPostProcessor` и вызывает метод `postProcessAfterInitialization`.  
На этом этапе можно подменить бин другим объектом или окончательно завершить его настройку.

---

## 7. Эксплуатация

Бин готов к использованию. На этом этапе приложение выполняет бизнес-логику, обращаясь к бину через контейнер.  
Все вызовы проходят через прокси (если бин был обёрнут, например, для AOP или транзакций).

---

## 8. Завершение работы и уничтожение бина

Когда контейнер закрывается (`context.close()`), Spring вызывает методы уничтожения. Возможны разные механизмы:

- Метод, помеченный `@PreDestroy`.
- Реализация интерфейса `DisposableBean` → вызов метода `destroy()`.
- Явно указанный `destroyMethod` в конфигурации `@Bean(destroyMethod = "shutdown")`.

Это позволяет корректно освободить ресурсы: закрыть соединения, остановить фоновые потоки, освободить кеши.

---

# Схема жизненного цикла

1. Создание объекта (конструктор).
2. Внедрение зависимостей.
3. Вызов Aware-интерфейсов.
4. Выполнение `BeanPostProcessor.postProcessBeforeInitialization()`.
5. Инициализация (`@PostConstruct`, `afterPropertiesSet()`, `initMethod`).
6. Выполнение `BeanPostProcessor.postProcessAfterInitialization()`.
7. Использование бина.
8. Уничтожение (`@PreDestroy`, `destroy()`, `destroyMethod`).
